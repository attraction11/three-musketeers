(function(global,factory){if(typeof define==="function"&&(define.amd||define.cmd)){define(factory)}else{global.Datalist=factory()}})(this,function(require){if(typeof require=="function"){require("common/ui/Follow")}else if(!$().follow){if(window.console){console.error("need Follow.js")}return{}}var CL="ui_tips",prefixTips=CL+"_";$.fn.tips=function(options){return $(this).each(function(){if(!$(this).data("tips")){$(this).data("tips",new Tips($(this),options))}})};var Tips=function(el,options){var defaults={attribute:"title",eventType:"hover",content:"",align:"center",delay:100,onShow:$.noop,onHide:$.noop};var params=$.extend({},defaults,options||{});var trigger=el,before,after;if(trigger.hasClass(CL)){var title=trigger.attr("title")||trigger.attr("data-title");if(title){trigger.attr("data-title",title).removeAttr("title")}if(!window.addEventListener){before=$('<span class="'+prefixTips+'before"></span>').html(title);after=$('<i class="'+prefixTips+'after"></i>');trigger.prepend(before);trigger.append(after);before.css("margin-left",before.outerWidth()*-.5);after.css("margin-left",after.outerWidth()*-.5)}trigger.data("tips",true);return}var self=this,tips,timer;var _content=function(){var content=params.content;if(!content){content=trigger.attr(params.attribute);if(params.attribute=="title"){content=content||trigger.data("title");if(content){trigger.data("title",content)}trigger.removeAttr("title")}}return content};this.el={trigger:trigger,tips:tips};this.callback={show:params.onShow,hide:params.onHide};this.align=params.align;if(params.eventType=="hover"){trigger.hover(function(){var content=_content();timer=setTimeout(function(){self.show(content)},params.delay)},function(){clearTimeout(timer);self.hide()})}else if(params.eventType=="click"){trigger.click(function(){self.show(_content())});$(document).mouseup(function(event){var target=event.target,dom=trigger.get(0);if(self.display==true&&dom!=target&&dom.contains(target)==false&&self.el.tips.get(0).contains(target)==false){self.hide()}})}else{this.show(_content())}return this};Tips.prototype.show=function(content){if(!content)return this;var trigger=this.el.trigger,tips=this.el.tips,before,after;if(tips){tips.show();before=tips.find("span").html(content);after=tips.find("i")}else{tips=$("<div></div>").addClass(prefixTips+"x");before=$('<span class="'+prefixTips+'before"></span>').html(content);after=$('<i class="'+prefixTips+'after"></i>');$(document.body).append(tips.append(before).append(after))}var offsetX=0,position="5-7";if(this.align=="left"){offsetX=-.5*before.width()+parseInt(before.css("padding-left"))||0}else if(this.align=="right"){offsetX=.5*before.width()-parseInt(before.css("padding-right"))||0}else if(this.align=="rotate"){position="6-8"}else if(typeof this.align=="number"){offsetX=this.align}tips.addClass(prefixTips+this.align);if(this.align!="rotate")after.css({left:offsetX});tips.follow(trigger,{offsets:{x:offsetX,y:0},position:position,edgeAdjust:false});this.callback.show.call(trigger,tips);this.el.tips=tips;this.display=true;return this};Tips.prototype.hide=function(){if(this.el.tips){this.el.tips.hide();this.callback.hide.call(this.el.trigger,this.el.tips)}this.display=false;return this};Tips.prototype.init=function(){var ie9=window.addEventListener;$("."+CL).tips();$(document).mouseover(function(event){var target=event&&event.target;if(target&&$(target).hasClass(CL)&&!$(target).data("tips")){$(target).tips()}});return this};return Tips});